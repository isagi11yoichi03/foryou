<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stickman Proposal Animation</title>
<style>
  body {
    margin: 0;
    background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }
  body::before {
    content: '';
    position: absolute;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255,255,255,0.08) 1px, transparent 1px);
    background-size: 40px 40px;
    animation: shimmer 30s linear infinite;
  }
  @keyframes shimmer {
    0% { transform: translate(0, 0); }
    100% { transform: translate(40px, 40px); }
  }
  canvas {
    border: none;
    border-radius: 24px;
    box-shadow: 0 25px 70px rgba(0,0,0,0.35), 0 0 50px rgba(255,255,255,0.15);
    position: relative;
    z-index: 1;
    cursor: pointer;
  }
</style>
</head>
<body>
<!-- <iframe 
  style="position: absolute; width: 0; height: 0; border: none; opacity: 0; pointer-events: none;" 
  scrolling="no" 
  frameborder="no" 
  allow="autoplay" 
  src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/58702532&color=%23ff5500&auto_play=true&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true">
</iframe> -->

<iframe
  src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/2077705176&auto_play=true"
  width="0"
  height="0"
  style="display:none;"
  frameborder="0"
  allow="autoplay">
</iframe>


<canvas id="scene" width="800" height="500"></canvas>

<script>
const canvas = document.getElementById("scene");
const ctx = canvas.getContext("2d");

let t = 0;
let boyX = -100; 
let phase = "walk";
let sceneMode = "spring"; // spring → summer → monsoon → snow → night
let snowflakes = [];
let raindrops = [];
let fireflies = [];

// Initialize snow particles
for (let i = 0; i < 80; i++) {
  snowflakes.push({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    radius: Math.random() * 2 + 1,
    speed: Math.random() * 0.5 + 0.3,
    drift: Math.random() * 0.5 - 0.25
  });
}

// Initialize rain
for (let i = 0; i < 100; i++) {
  raindrops.push({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    length: Math.random() * 15 + 10,
    speed: Math.random() * 3 + 4
  });
}

// Initialize fireflies
for (let i = 0; i < 15; i++) {
  fireflies.push({
    x: Math.random() * canvas.width,
    y: Math.random() * 300 + 50,
    vx: (Math.random() - 0.5) * 0.5,
    vy: (Math.random() - 0.5) * 0.5,
    brightness: Math.random()
  });
}

canvas.addEventListener('click', (e) => {
  const rect = canvas.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  
  const dist = Math.sqrt((x - 700) ** 2 + (y - 100) ** 2);
  if (dist < 100) {
    if (sceneMode === "spring") sceneMode = "summer";
    else if (sceneMode === "summer") sceneMode = "monsoon";
    else if (sceneMode === "monsoon") sceneMode = "snow";
    else if (sceneMode === "snow") sceneMode = "night";
    else if (sceneMode === "night") sceneMode = "spring";
  }
});

function drawStickman(x, y, scale, color, pose, clothing) {
  ctx.save();
  ctx.translate(x, y);
  ctx.scale(scale, scale);
  ctx.lineWidth = 3;
  ctx.strokeStyle = color;
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  ctx.beginPath();

  // Body
  ctx.moveTo(0, 0);
  ctx.lineTo(0, -40);
  // Head
  ctx.moveTo(0, -55);
  ctx.arc(0, -55, 15, 0, Math.PI * 2);

  // Clothing
  if (clothing === "sweater") {
    ctx.stroke();
    ctx.fillStyle = "#c0392b";
    ctx.beginPath();
    ctx.moveTo(-14, -40);
    ctx.lineTo(-14, -20);
    ctx.quadraticCurveTo(-14, -15, -10, -15);
    ctx.lineTo(10, -15);
    ctx.quadraticCurveTo(14, -15, 14, -20);
    ctx.lineTo(14, -40);
    ctx.closePath();
    ctx.fill();
    ctx.strokeStyle = color;
    ctx.beginPath();
  } else if (clothing === "summer") {
    ctx.stroke();
    ctx.fillStyle = "#3498db";
    ctx.beginPath();
    ctx.moveTo(-12, -40);
    ctx.lineTo(-12, -25);
    ctx.quadraticCurveTo(-12, -22, -9, -22);
    ctx.lineTo(9, -22);
    ctx.quadraticCurveTo(12, -22, 12, -25);
    ctx.lineTo(12, -40);
    ctx.closePath();
    ctx.fill();
    ctx.strokeStyle = color;
    ctx.beginPath();
  } else if (clothing === "raincoat") {
    ctx.stroke();
    ctx.fillStyle = "#f39c12";
    ctx.beginPath();
    ctx.moveTo(-15, -40);
    ctx.lineTo(-15, -10);
    ctx.quadraticCurveTo(-15, -5, -10, -5);
    ctx.lineTo(10, -5);
    ctx.quadraticCurveTo(15, -5, 15, -10);
    ctx.lineTo(15, -40);
    ctx.closePath();
    ctx.fill();
    ctx.strokeStyle = color;
    ctx.beginPath();
  }

  // Arms
  if (pose === "walk") {
    const armSwing = Math.sin(t * 0.1) * 15;
    ctx.moveTo(0, -30);
    ctx.lineTo(-12, -18 + armSwing);
    ctx.moveTo(0, -30);
    ctx.lineTo(12, -18 - armSwing);
  } else if (pose === "kneel") {
    ctx.moveTo(0, -30);
    ctx.lineTo(-15, -10);
    ctx.moveTo(0, -30);
    ctx.lineTo(20, -45);
  } else if (pose === "propose") {
    ctx.moveTo(0, -30);
    ctx.lineTo(-15, -5);
    ctx.moveTo(0, -30);
    ctx.lineTo(20, -50);
    ctx.stroke();
    // Flower
    ctx.beginPath();
    ctx.strokeStyle = "#27ae60";
    ctx.lineWidth = 2.5;
    ctx.moveTo(20, -50);
    ctx.lineTo(25, -68);
    ctx.stroke();
    
    // Petals
    for (let i = 0; i < 5; i++) {
      const angle = (i / 5) * Math.PI * 2;
      ctx.fillStyle = "#e74c3c";
      ctx.beginPath();
      ctx.arc(25 + Math.cos(angle) * 5, -73 + Math.sin(angle) * 5, 4, 0, Math.PI * 2);
      ctx.fill();
    }
    ctx.fillStyle = "#f1c40f";
    ctx.beginPath();
    ctx.arc(25, -73, 3, 0, Math.PI * 2);
    ctx.fill();
    
    ctx.strokeStyle = color;
    ctx.lineWidth = 3;
  } else {
    ctx.moveTo(0, -30);
    ctx.lineTo(-20, -30);
    ctx.moveTo(0, -30);
    ctx.lineTo(20, -30);
  }

  // Legs
  if (pose === "kneel" || pose === "propose") {
    ctx.moveTo(0, 0);
    ctx.lineTo(-20, 10);
    ctx.moveTo(0, 0);
    ctx.lineTo(20, -10);
  } else if (pose === "walk") {
    const legSwing = Math.sin(t * 0.1) * 20;
    ctx.moveTo(0, 0);
    ctx.lineTo(-8 + legSwing * 0.4, 22 + Math.abs(legSwing) * 0.15);
    ctx.moveTo(0, 0);
    ctx.lineTo(8 - legSwing * 0.4, 22 + Math.abs(legSwing) * 0.15);
  } else {
    ctx.moveTo(0, 0);
    ctx.lineTo(-15, 25);
    ctx.moveTo(0, 0);
    ctx.lineTo(15, 25);
  }

  ctx.stroke();
  ctx.restore();
}

function drawSoftTree(x, y, scale = 1) {
  ctx.save();
  ctx.translate(x, y);
  ctx.scale(scale, scale);
  
  // Trunk
  const trunkGradient = ctx.createLinearGradient(-4, -25, 4, 0);
  trunkGradient.addColorStop(0, "#8B6914");
  trunkGradient.addColorStop(1, "#654321");
  ctx.fillStyle = trunkGradient;
  ctx.beginPath();
  ctx.moveTo(-5, 0);
  ctx.quadraticCurveTo(-5, -10, -4, -25);
  ctx.lineTo(4, -25);
  ctx.quadraticCurveTo(5, -10, 5, 0);
  ctx.closePath();
  ctx.fill();
  
  // Foliage layers
  const treeColor = sceneMode === "snow" ? "#1e5631" : "#2d7a2d";
  ctx.fillStyle = treeColor;
  
  // Bottom layer
  ctx.beginPath();
  ctx.moveTo(-22, -25);
  ctx.quadraticCurveTo(-25, -35, -18, -45);
  ctx.quadraticCurveTo(-10, -52, 0, -55);
  ctx.quadraticCurveTo(10, -52, 18, -45);
  ctx.quadraticCurveTo(25, -35, 22, -25);
  ctx.closePath();
  ctx.fill();
  
  // Middle layer
  ctx.beginPath();
  ctx.moveTo(-18, -40);
  ctx.quadraticCurveTo(-20, -50, -15, -58);
  ctx.quadraticCurveTo(-8, -65, 0, -68);
  ctx.quadraticCurveTo(8, -65, 15, -58);
  ctx.quadraticCurveTo(20, -50, 18, -40);
  ctx.closePath();
  ctx.fill();
  
  // Top layer
  ctx.beginPath();
  ctx.moveTo(-14, -55);
  ctx.quadraticCurveTo(-15, -65, -10, -72);
  ctx.quadraticCurveTo(-5, -78, 0, -80);
  ctx.quadraticCurveTo(5, -78, 10, -72);
  ctx.quadraticCurveTo(15, -65, 14, -55);
  ctx.closePath();
  ctx.fill();
  
  // Snow on tree
  if (sceneMode === "snow") {
    ctx.fillStyle = "rgba(255,255,255,0.9)";
    ctx.beginPath();
    ctx.ellipse(0, -25, 22, 6, 0, 0, Math.PI * 2);
    ctx.fill();
    ctx.beginPath();
    ctx.ellipse(0, -40, 18, 5, 0, 0, Math.PI * 2);
    ctx.fill();
    ctx.beginPath();
    ctx.ellipse(0, -55, 14, 4, 0, 0, Math.PI * 2);
    ctx.fill();
  }
  
  ctx.restore();
}

function drawFlower(x, y, petalColor) {
  // Stem
  ctx.strokeStyle = "#27ae60";
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(x, y);
  ctx.quadraticCurveTo(x + 2, y - 10, x, y - 20);
  ctx.stroke();
  
  // Petals
  for (let i = 0; i < 5; i++) {
    const angle = (i / 5) * Math.PI * 2;
    ctx.fillStyle = petalColor;
    ctx.beginPath();
    ctx.arc(x + Math.cos(angle) * 4, y - 20 + Math.sin(angle) * 4, 3, 0, Math.PI * 2);
    ctx.fill();
  }
  
  // Center
  ctx.fillStyle = "#f1c40f";
  ctx.beginPath();
  ctx.arc(x, y - 20, 2, 0, Math.PI * 2);
  ctx.fill();
}

function drawCloud(x, y, scale) {
  ctx.fillStyle = "rgba(255,255,255,0.8)";
  ctx.beginPath();
  ctx.arc(x, y, 20 * scale, 0, Math.PI * 2);
  ctx.arc(x + 25 * scale, y - 5 * scale, 25 * scale, 0, Math.PI * 2);
  ctx.arc(x + 50 * scale, y, 20 * scale, 0, Math.PI * 2);
  ctx.arc(x + 35 * scale, y + 10 * scale, 20 * scale, 0, Math.PI * 2);
  ctx.fill();
}

function drawShed(x, y) {
  // Shed body
  ctx.fillStyle = "#8B4513";
  ctx.fillRect(x, y, 120, 80);
  
  // Roof
  ctx.fillStyle = "#654321";
  ctx.beginPath();
  ctx.moveTo(x - 10, y);
  ctx.lineTo(x + 60, y - 40);
  ctx.lineTo(x + 130, y);
  ctx.closePath();
  ctx.fill();
  
  // Door
  ctx.fillStyle = "#5a3a1a";
  ctx.beginPath();
  ctx.roundRect(x + 45, y + 20, 30, 60, 5);
  ctx.fill();
}

function drawGround() {
  let gradient;
  
  if (sceneMode === "spring") {
    gradient = ctx.createLinearGradient(0, 400, 0, 500);
    gradient.addColorStop(0, "#90EE90");
    gradient.addColorStop(1, "#7CCD7C");
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 400, canvas.width, 100);
    
    // Grass
    ctx.strokeStyle = "rgba(120,200,120,0.4)";
    ctx.lineWidth = 1.5;
    for (let i = 0; i < 60; i++) {
      const x = (i * 15 + t * 0.2) % canvas.width;
      ctx.beginPath();
      ctx.moveTo(x, 400);
      ctx.quadraticCurveTo(x + 1, 395, x + 2, 390);
      ctx.stroke();
    }
    
    // Spring flowers
    const flowerColors = ["#ff6b9d", "#c44569", "#f8b500", "#a29bfe"];
    for (let i = 0; i < 15; i++) {
      const fx = (i * 60 + 30) % canvas.width;
      drawFlower(fx, 400, flowerColors[i % flowerColors.length]);
    }
    
  } else if (sceneMode === "summer") {
    // Sandy beach
    gradient = ctx.createLinearGradient(0, 400, 0, 500);
    gradient.addColorStop(0, "#f4e4c1");
    gradient.addColorStop(1, "#ddc9a3");
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 400, canvas.width, 100);
    
    // Ocean waves
    for (let i = 0; i < 4; i++) {
      ctx.fillStyle = `rgba(64,164,223,${0.3 - i * 0.05})`;
      ctx.beginPath();
      for (let x = 0; x < canvas.width; x += 3) {
        const y = 395 + i * 5 + Math.sin((x + t * 1.5) * 0.04) * 4;
        if (x === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      }
      ctx.lineTo(canvas.width, 500);
      ctx.lineTo(0, 500);
      ctx.closePath();
      ctx.fill();
    }
    
  } else if (sceneMode === "monsoon") {
    gradient = ctx.createLinearGradient(0, 400, 0, 500);
    gradient.addColorStop(0, "#556b2f");
    gradient.addColorStop(1, "#3d4f1f");
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 400, canvas.width, 100);
    
    // Puddles
    ctx.fillStyle = "rgba(100,130,150,0.4)";
    for (let i = 0; i < 5; i++) {
      ctx.beginPath();
      ctx.ellipse(100 + i * 150, 420 + Math.sin(i) * 10, 40, 15, 0, 0, Math.PI * 2);
      ctx.fill();
    }
    
  } else if (sceneMode === "snow") {
    gradient = ctx.createLinearGradient(0, 400, 0, 500);
    gradient.addColorStop(0, "#f0f8ff");
    gradient.addColorStop(1, "#e1f0fa");
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 400, canvas.width, 100);
    
  } else { // night
    gradient = ctx.createLinearGradient(0, 400, 0, 500);
    gradient.addColorStop(0, "#1a3d2e");
    gradient.addColorStop(1, "#0f2419");
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 400, canvas.width, 100);
    
    // Soft grass
    ctx.strokeStyle = "rgba(80,120,80,0.3)";
    ctx.lineWidth = 1.5;
    for (let i = 0; i < 50; i++) {
      const x = (i * 18 + t * 0.15) % canvas.width;
      ctx.beginPath();
      ctx.moveTo(x, 400);
      ctx.quadraticCurveTo(x + 1, 395, x + 2, 391);
      ctx.stroke();
    }
  }
}

function drawSky() {
  if (sceneMode === "spring" || sceneMode === "summer") {
    // Sun
    const gradient = ctx.createRadialGradient(700, 100, 0, 700, 100, 100);
    gradient.addColorStop(0, "rgba(255,240,150,1)");
    gradient.addColorStop(0.4, "rgba(255,220,130,0.7)");
    gradient.addColorStop(1, "rgba(255,200,100,0)");
    ctx.fillStyle = gradient;
    ctx.beginPath();
    ctx.arc(700, 100, 80 + Math.sin(t * 0.02) * 4, 0, Math.PI * 2);
    ctx.fill();
    
    // Soft rays
    ctx.strokeStyle = "rgba(255,230,150,0.15)";
    ctx.lineWidth = 3;
    ctx.lineCap = "round";
    for (let i = 0; i < 12; i++) {
      const angle = (i / 12) * Math.PI * 2 + t * 0.005;
      const len = 40 + Math.sin(t * 0.03 + i) * 6;
      ctx.beginPath();
      ctx.moveTo(700 + Math.cos(angle) * 45, 100 + Math.sin(angle) * 45);
      ctx.lineTo(700 + Math.cos(angle) * (45 + len), 100 + Math.sin(angle) * (45 + len));
      ctx.stroke();
    }
    
    if (sceneMode === "summer") {
      // Clouds
      drawCloud(150 + Math.sin(t * 0.01) * 20, 80, 0.8);
      drawCloud(400 + Math.sin(t * 0.008) * 30, 120, 1);
      drawCloud(550 + Math.sin(t * 0.012) * 15, 90, 0.7);
    }
    
  } else if (sceneMode === "monsoon") {
    // Hidden sun behind clouds
    ctx.fillStyle = "rgba(200,200,180,0.3)";
    ctx.beginPath();
    ctx.arc(700, 100, 60, 0, Math.PI * 2);
    ctx.fill();
    
  } else if (sceneMode === "snow" || sceneMode === "night") {
    // Moon
    const gradient = ctx.createRadialGradient(700, 100, 0, 700, 100, 70);
    gradient.addColorStop(0, "rgba(250,250,240,1)");
    gradient.addColorStop(0.6, "rgba(235,235,225,0.5)");
    gradient.addColorStop(1, "rgba(220,220,210,0)");
    ctx.fillStyle = gradient;
    ctx.beginPath();
    ctx.arc(700, 100, 65, 0, Math.PI * 2);
    ctx.fill();
    
    // Moon craters
    ctx.fillStyle = "rgba(210,210,200,0.3)";
    ctx.beginPath();
    ctx.arc(690, 95, 8, 0, Math.PI * 2);
    ctx.fill();
    ctx.beginPath();
    ctx.arc(710, 110, 6, 0, Math.PI * 2);
    ctx.fill();
    ctx.beginPath();
    ctx.arc(705, 90, 5, 0, Math.PI * 2);
    ctx.fill();
    
    // Stars
    if (sceneMode === "night" || sceneMode === "snow") {
      ctx.fillStyle = "rgba(255,255,255,0.9)";
      for (let i = 0; i < 60; i++) {
        const x = (i * 73 + 50) % (canvas.width - 100) + 30;
        const y = 30 + (i * 47) % 300;
        const twinkle = Math.sin(t * 0.03 + i) * 0.4 + 0.6;
        ctx.globalAlpha = twinkle;
        ctx.beginPath();
        ctx.arc(x, y, i % 7 === 0 ? 2 : 1.2, 0, Math.PI * 2);
        ctx.fill();
      }
      ctx.globalAlpha = 1;
    }
  }
}

function drawWeather() {
  if (sceneMode === "monsoon") {
    // Rainfall
    ctx.strokeStyle = "rgba(174,214,241,0.6)";
    ctx.lineWidth = 1.5;
    ctx.lineCap = "round";
    for (let drop of raindrops) {
      ctx.beginPath();
      ctx.moveTo(drop.x, drop.y);
      ctx.lineTo(drop.x - 2, drop.y + drop.length);
      ctx.stroke();
      
      drop.y += drop.speed;
      drop.x -= 1;
      if (drop.y > canvas.height) {
        drop.y = -20;
        drop.x = Math.random() * canvas.width;
      }
    }
  } else if (sceneMode === "snow") {
    // Gentle snowfall
    for (let flake of snowflakes) {
      ctx.fillStyle = `rgba(255,255,255,${0.7 + Math.sin(t * 0.05 + flake.y) * 0.3})`;
      ctx.beginPath();
      ctx.arc(flake.x, flake.y, flake.radius, 0, Math.PI * 2);
      ctx.fill();
      
      flake.y += flake.speed;
      flake.x += flake.drift + Math.sin(t * 0.02 + flake.y * 0.01) * 0.3;
      
      if (flake.y > canvas.height) {
        flake.y = -10;
        flake.x = Math.random() * canvas.width;
      }
      if (flake.x < 0) flake.x = canvas.width;
      if (flake.x > canvas.width) flake.x = 0;
    }
  }
}

function drawFireflies() {
  if (sceneMode === "night") {
    for (let fly of fireflies) {
      fly.brightness += (Math.random() - 0.5) * 0.1;
      fly.brightness = Math.max(0.2, Math.min(1, fly.brightness));
      
      ctx.fillStyle = `rgba(255,255,150,${fly.brightness * 0.8})`;
      ctx.beginPath();
      ctx.arc(fly.x, fly.y, 3, 0, Math.PI * 2);
      ctx.fill();
      
      // Glow
      const glowGradient = ctx.createRadialGradient(fly.x, fly.y, 0, fly.x, fly.y, 15);
      glowGradient.addColorStop(0, `rgba(255,255,150,${fly.brightness * 0.4})`);
      glowGradient.addColorStop(1, "rgba(255,255,150,0)");
      ctx.fillStyle = glowGradient;
      ctx.beginPath();
      ctx.arc(fly.x, fly.y, 15, 0, Math.PI * 2);
      ctx.fill();
      
      fly.x += fly.vx;
      fly.y += fly.vy;
      
      if (fly.x < 0 || fly.x > canvas.width) fly.vx *= -1;
      if (fly.y < 50 || fly.y > 350) fly.vy *= -1;
    }
  }
}

function getStickmanColor() {
  if (sceneMode === "night" || sceneMode === "snow") {
    return "#d5d5d5";
  }
  return "#2c3e50";
}

function getClothing() {
  if (sceneMode === "snow") return "sweater";
  if (sceneMode === "summer") return "summer";
  if (sceneMode === "monsoon") return "raincoat";
  return "normal";
}

function drawHeart(x, y, size, opacity) {
  ctx.save();
  ctx.globalAlpha = opacity;
  ctx.translate(x, y);
  ctx.scale(size, size);
  ctx.fillStyle = "#ff6b9d";
  ctx.beginPath();
  ctx.moveTo(0, 0);
  ctx.bezierCurveTo(-10, -10, -15, 5, 0, 15);
  ctx.bezierCurveTo(15, 5, 10, -10, 0, 0);
  ctx.fill();
  ctx.restore();
}

function drawScene() {
  let colors;
  if (sceneMode === "spring") {
    colors = { sky1: "#E3F2FD", sky2: "#B3E5FC", sky3: "#FFE4E1", sky4: "#FFDAB9" };
  } else if (sceneMode === "summer") {
    colors = { sky1: "#87CEEB", sky2: "#ADD8E6", sky3: "#B0E0E6", sky4: "#AFEEEE" };
  } else if (sceneMode === "monsoon") {
    colors = { sky1: "#6B7C93", sky2: "#7C8FA3", sky3: "#8D9DB0", sky4: "#9DABBE" };
  } else if (sceneMode === "snow") {
    colors = { sky1: "#2c3e50", sky2: "#34495e", sky3: "#4a5f7f", sky4: "#5b7290" };
  } else { // night
    colors = { sky1: "#0a1128", sky2: "#1a1f3a", sky3: "#252a48", sky4: "#2d3250" };
  }
  
  const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
  gradient.addColorStop(0, colors.sky1);
  gradient.addColorStop(0.4, colors.sky2);
  gradient.addColorStop(0.7, colors.sky3);
  gradient.addColorStop(1, colors.sky4);
  ctx.fillStyle = gradient;
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  
  drawSky();
  drawWeather();
  
  // Trees
  if (sceneMode !== "summer") {
    drawSoftTree(140, 400, 0.9);
    drawSoftTree(280, 400, 1.1);
    if (sceneMode !== "monsoon") {
      drawSoftTree(680, 400, 0.85);
    }
  }
  
  // Shed for monsoon
  if (sceneMode === "monsoon") {
    drawShed(480, 320);
  }
  
  drawGround();
  drawFireflies();

  const stickColor = getStickmanColor();
  const clothing = getClothing();

  // Adjust positions for monsoon shed
  let girlX = 600;
  let finalBoyX = 520;
  
  if (sceneMode === "monsoon" && phase !== "walk") {
    girlX = 580;
    finalBoyX = 500;
  }

  // Girl stick figure
  drawStickman(girlX, 400, 1, stickColor, phase === "blush" ? "shy" : "stand", clothing);
  
  // Boy stick figure
  let boyPose = "walk";
  if (phase === "kneel") boyPose = "kneel";
  if (phase === "propose") boyPose = "propose";
  drawStickman(boyX, 400, 1, stickColor, boyPose, clothing);

  if (phase === "propose" || phase === "blush") {
    // Soft transparent hearts
    for (let i = 0; i < 2; i++) {
      const offset = i * 50;
      const opacity = 0.2 + Math.sin(t * 0.05 + i) * 0.12;
      const floatProgress = ((t * 0.3) % 150);
      drawHeart(
        540 + Math.sin(t * 0.08 + i * 0.5) * 6,
        300 + offset - floatProgress + Math.cos(t * 0.06 + i) * 5,
        1.2 + Math.sin(t * 0.1 + i) * 0.12,
        opacity
      );
    }
  }

  if (phase === "blush") {
    // Soft blush
    ctx.fillStyle = "rgba(255,130,150,0.5)";
    ctx.beginPath();
    ctx.arc(girlX - 10, 345, 4 + Math.sin(t * 0.18) * 1.2, 0, Math.PI * 2);
    ctx.arc(girlX + 10, 345, 4 + Math.sin(t * 0.18) * 1.2, 0, Math.PI * 2);
    ctx.fill();
    
    // Gentle sparkles
    ctx.fillStyle = "rgba(255,230,180,0.6)";
    for (let i = 0; i < 8; i++) {
      const angle = (i / 8) * Math.PI * 2 + t * 0.05;
      const radius = 50 + Math.sin(t * 0.08) * 6;
      const x = (girlX - 20) + Math.cos(angle) * radius;
      const y = 340 + Math.sin(angle) * radius;
      const twinkle = Math.sin(t * 0.1 + i) * 0.4 + 0.6;
      ctx.globalAlpha = twinkle;
      ctx.beginPath();
      ctx.arc(x, y, 1.8, 0, Math.PI * 2);
      ctx.fill();
    }
    ctx.globalAlpha = 1;
  }
}

function animate() {
  t++;

  if (phase === "walk") {
    boyX += 1.5;
    const targetX = sceneMode === "monsoon" ? 500 : 520;
    if (boyX > targetX) phase = "kneel";
  } else if (phase === "kneel") {
    if (t % 80 === 0) phase = "propose";
  } else if (phase === "propose") {
    if (t % 250 === 0) phase = "blush";
  }

  drawScene();
  requestAnimationFrame(animate);
}

animate();
</script>
</body>
</html>